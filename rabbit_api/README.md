# Сервис нотификации данных
Сервис позволяет уведомлять пользователей Проекта о следующих событиях:

1) необходимости подтвердить регистрацию;
2) просмотренных за неделю фильмах

Способ отправки уведомлений - электронное письмо.

### Запуск проекта
1. Создать файл .env по примеру .env.example.
особое внимание обратите на параметры почтового сервера: 
EMAIL_SERVER_ADDRESS EMAIL_SERVER_PORT EMAIL_ACCOUNT_LOGIN EMAIL_ACCOUNT_PASSWORD
2. Отметить в виду источника папки rabbit_api/src; rabbit_api/sender/src и rabbit_api/render/src
3. Для поднятия проекта используйте команду
```
make run_rabbit
```

### Миграции данных
Для миграции данных используется библиотека alembic.
Для перехода в папку api выполните команду
```
cd rabbit_api/src
```
При первом использовании необходимо создать папку миграции с помощью команды
```
alembic init migrations
```
В результате выполнения команды будет создан файл alembic.ini и папка migrations.
В файле alembic.ini необходимо указать sqlalchemy.url с данными из .env папки и БД, которую собираетесь использовать.
В папке migrations есть папка verdions, которая хранит версии миграции (python-скрипты),
В файле env.py через метод set_section_option передаем переменной config все данные о БД.
В переменной target_metadata указываем metadata из models.


Для создания миграции выполните команду. Команда сравнит текущее состояние в БД и того, что описано в моделях.
После -m укажите комментарий в кавычках
```
alembic revision --autogenerate -m "Database creation"
```
В результате в папке migrations/versions будет создан файл миграции.
Для лучшего отслеживания рекомендуется переимновывать созданные файлы миграции, добавляя в начало дату создания.
Чтобы запустить миграцию, пропишите команду (revision берется из файла миграции)
```
alembic upgrade <revision>
```
или
```
alembic upgrade head
```

### Документация API

[Схема API](http://localhost:8000/api/openapi)

